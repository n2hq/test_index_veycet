import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as s,c as S}from"./components-DPfHZ1Ve.js";import{A as N}from"./AccountLayout-D_sH2dba.js";import{C as y}from"./ContentLayout-DGf8_Bh-.js";import{aF as D,B as I,a as P,O as _,aG as C,a3 as G}from"./lib-B83UiCcG.js";import{u as M,a as k}from"./EditPhotoDialogContext-Chxo20qU.js";import{u as A}from"./NotificationContext-BGyxjMcq.js";import{I as L}from"./index-BVQZtB2M.js";import{u as B}from"./SliderContext-DKrZiyDV.js";import{u as E}from"./AuthContext-DKUMkAUy.js";import{O as R}from"./OperationContext-DEJBADlp.js";import{L as z}from"./LoadingMessage-CO2lhh43.js";import"./AccountUserImage-DUVY_Zmu.js";import"./HomeNav-Bd3MTT6k.js";import"./MainNav-C35PW04j.js";import"./BusinessMenu-eJb8kUdc.js";import"./BusinessDrawer-Bp9_ABtu.js";const U=({userGuid:t,businessGuid:r})=>{const a=s.useRef(null),[n,l]=s.useState(null),[d,u]=s.useState(null),[i,o]=s.useState(!1),[p,x]=s.useState(!1),[c,m]=s.useState(!1),h=M(),b=g=>{var j;try{const f=(j=g.target.files)==null?void 0:j[0];if(f){const w=URL.createObjectURL(f);l(w),u(f),o(!0),h.setDialog(!0),h.setImgSrc(w),h.setSelectedFile(f),h.setIsImageSelected(!0),h.setUserGuid(t),h.setBusinessGuid(r)}}finally{g.target.value=""}},v=()=>{var g;(g=a.current)==null||g.click()};return e.jsxs("div",{className:"mb-2",children:[e.jsx("button",{onMouseDown:v,className:` bg-blue-800 rounded-md px-3 py-1
                text-white hover:bg-blue-700 transition
                duration-500 ease-in-out hover:shadow-md
                 shadow-gray-900 hover:shadow-black/50`,children:"Add Photo"}),e.jsx("input",{type:"file",accept:"image/*",ref:a,className:" hidden",onChange:b})]})},O=({item:t,menu:r,userGuid:a,businessGuid:n})=>{const[l,d]=s.useState(!1),[u,i]=s.useState(null),o=k();A();const p="https://tpics.gasimg.com",x=()=>{o.setDialog(!0),o.setImgSrc(p+t.image_url),o.setImageTitle(t.image_title),o.setUserGuid(a),o.setBusinessGuid(n),o.setImageGuid(t.image_guid),d(!0)},c=async()=>{o.deletePhoto(a,n,t.image_guid)};return e.jsx("div",{className:"",children:r&&e.jsx("div",{className:` absolute top-2 right-2 w-[80%] bg-white
                rounded-[12px] overflow-hidden border-[1px] border-white
                shadow-md`,children:e.jsx("div",{className:"mt-3",children:e.jsxs("div",{className:" divide-y-[1px]",children:[e.jsx("div",{onMouseDown:x,className:`py-1 hover:bg-gray-300 w-full
                                flex flex-col
                                px-2 transition duration-1000 ease-in-out`,children:"Edit"}),e.jsx("div",{onMouseDown:c,className:`py-1 hover:bg-gray-300 w-full
                                flex flex-col
                                px-2 transition duration-1000 ease-in-out`,children:"Delete"})]})})})})},F=({showCarousel:t,item:r,itemIndex:a,userGuid:n,businessGuid:l})=>{const[d,u]=s.useState(!1),i="https://tpics.gasimg.com";let o="";r.image_url?o=i+r.image_url:o="https://trendyblinds.ca/wp-content/uploads/2023/09/3.-3D-WALLPAPER-SKU0015.jpg";const[p,x]=s.useState(o),c=()=>{u(!0)},m=async()=>{await new Promise(h=>setTimeout(h,200)),u(!1)};return e.jsx("div",{className:"z-0",children:e.jsxs("div",{className:`border-[1px] h-fit p-1 rounded-md shadow-md
                    hover:cursor-pointer relative z-0`,children:[e.jsx("button",{onMouseDown:c,onBlur:m,className:`w-[30px] h-[30px] z-50 bg-white 
                flex place-content-center place-items-center 
                rounded-full absolute right-2 top-2 cursor-pointer
                hover:bg-gray-500 hover:text-white/80 transition duration-1000 ease-in-out`,children:e.jsx(D,{className:"text-[20px]"})}),e.jsx("div",{onMouseDown:h=>t(a),className:`relative h-[100px] md:h-[170px] xl:h-[160px]
                         rounded-md overflow-hidden -z-10
                    `,children:e.jsx("img",{src:p,alt:"",className:`object-cover w-full h-full -z-40
                        `})}),r.image_title.length>0&&e.jsx("div",{className:"text-[13px] mt-2 mb-1.5 leading-[1.2em] mx-[2px] line-clamp-2",children:r.image_title}),e.jsx(O,{item:r,menu:d,userGuid:n,businessGuid:l})]})})},T=({slides:t,selectedSlide:r,handleClose:a})=>{const[n,l]=s.useState(0);s.useRef(0),s.useRef(0);const d=()=>{l(i=>i===0?t.length-1:i-1)},u=()=>{l(i=>i===t.length-1?0:i+1)};return s.useEffect(()=>{r!==null&&l(r-1)},[r]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-12 gap-0 ",children:[e.jsxs("div",{className:"col-span-12 md:col-span-9 w-full h-full relative bg-black flex",children:[e.jsx("div",{className:" w-auto h-screen flex overflow-hidden",children:t.map((i,o)=>e.jsx("img",{src:i.image_url,alt:"",style:{transform:`translateX(-${n*100}%)`},className:`object-scale-down w-full h-full 
                                            block flex-shrink-0 flex-grow-0 transition-transform
                                            ease-in-out duration-1000`},o))}),e.jsx("button",{onMouseDown:d,className:`block absolute top-0 bottom-0 
                p-[1rem] cursor-pointer left-0 group h-full 
                transition duration-1000 ease-in-out`,children:e.jsx("div",{className:`w-[50px] h-[50px] bg-white/60 rounded-full place-content-center place-items-center group-hover:bg-white/30
                        transition duration-500 ease-in-out`,children:e.jsx(I,{className:" stroke-white fill-black w-[2rem] h-[2rem]"})})}),e.jsx("button",{onMouseDown:u,className:`block absolute top-0 bottom-0 
                    p-[1rem] cursor-pointer right-0 group 
                     transition duration-1000 ease-in-out`,children:e.jsx("div",{className:`w-[50px] h-[50px] bg-white/60 rounded-full flex place-content-center place-items-center group-hover:bg-white/30
                        transition duration-500 ease-in-out`,children:e.jsx(P,{className:" stroke-white fill-black w-[2rem] h-[2rem]"})})}),e.jsx("div",{onMouseDown:()=>a(),className:`w-[50px] h-[50px] z-[300] bg-white
                    flex place-content-center place-items-center
                    rounded-full absolute left-2 top-2 cursor-pointer
                    hover:bg-white/40 transition duration-1000 ease-in-out`,children:e.jsx(L,{className:"text-[30px]"})})]}),e.jsxs("div",{className:"hidden md:block md:col-span-3 px-5",children:[e.jsx("h1",{className:" text-[22px] my-4 font-sans font-extrabold tracking-tight leading-[24px]",children:"Photos for Jason Won, DPT - Flex With Doctor Jay"}),e.jsxs("div",{className:" my-4 ",children:[n+1," / ",t.length]}),e.jsx("hr",{}),e.jsx("div",{className:" my-4",children:t[n].image_title})]})]})})},W=({overlay:t,setOverlay:r,selectedSlide:a,handleClose:n,gallery:l})=>e.jsx("div",{children:t&&e.jsx("div",{className:`flex w-screen h-screen bg-white z-[1000] 
                fixed top-0 left-0 right-0 bottom-0 `,children:l&&a&&e.jsx(T,{slides:l,selectedSlide:a,handleClose:n})})}),J=({gallery:t,userGuid:r,businessGuid:a,listing:n})=>{const[l,d]=s.useState(!1),[u,i]=s.useState(0),o=B(),p=()=>{d(!1)},x=c=>{o.setDialog(!0),o.setSelectedSlide(c+1),o.setGallery(t),o.setListing(n)};return e.jsxs("div",{className:"",children:[e.jsx("div",{className:` border-[1px] p-3 rounded-[5px] 
                grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4
                lg:grid-cols-4 xl:grid-cols-5 gap-2 z-0`,children:t.map((c,m)=>e.jsx("div",{className:"z-0",children:e.jsx(F,{showCarousel:x,item:c,itemIndex:m,userGuid:r,businessGuid:a})},m))}),e.jsx(W,{overlay:l,setOverlay:d,selectedSlide:u+1,handleClose:p,gallery:t})]})},ie=()=>{s.useEffect(()=>{_(localStorage)},[]);const[t,r]=s.useState(""),[a,n]=s.useState(""),[l,d]=s.useState(null),[u,i]=s.useState(null),[o,p]=s.useState(!0),{business_guid:x,user_guid:c}=S(),[m,h]=s.useState(null);return E()?(s.useEffect(()=>{const v=async(g,j)=>{r(g),n(j);const f=await C(g,j);d(f);const w=await G(g||"");h(w)};try{x&&c&&v(x,c)}catch(g){console.log(g.message)}},[x,c]),s.useEffect(()=>{t&&a&&l&&m&&(i({businessGuid:t,userGuid:a,gallery:l,businessProfile:m}),p(!1))},[t,a,l,m]),o?e.jsx(z,{}):e.jsx(N,{children:e.jsx(y,{title:"Gallery Settings",businessGuid:t,data:u,businessProfile:m,children:e.jsxs(R,{children:[t&&a&&e.jsx(U,{userGuid:a,businessGuid:t}),l.length>0?e.jsx("div",{className:"z-0",children:e.jsx(J,{gallery:l,userGuid:a,businessGuid:t,listing:m})}):e.jsx("div",{className:" mt-2 border-[1px] rounded-lg p-3 mb-6",children:"Gallery is empty"})]})})})):null};export{ie as default};
