import{j as s}from"./jsx-runtime-0DLF9kdB.js";import{u as A,a as W}from"./zod-CC5ug8f6.js";import{r as n,c as L}from"./components-DPfHZ1Ve.js";import{ad as F,O as $,ae as D,a3 as G}from"./lib-B83UiCcG.js";import{o as I,s as l,u as N,a as i,l as O,Z as R}from"./types-DBTFAyTi.js";import{A as V}from"./AccountLayout-D_sH2dba.js";import{C as M}from"./ContentLayout-DGf8_Bh-.js";import{u as Z}from"./NotificationContext-BGyxjMcq.js";import{u as q,O as z}from"./OperationContext-DEJBADlp.js";import{f as U}from"./css-CVxtJxAn.js";import{u as Y}from"./AuthContext-DKUMkAUy.js";import{L as J}from"./LoadingMessage-CO2lhh43.js";import"./AccountUserImage-DUVY_Zmu.js";import"./HomeNav-Bd3MTT6k.js";import"./MainNav-C35PW04j.js";import"./index-BVQZtB2M.js";import"./BusinessMenu-eJb8kUdc.js";import"./BusinessDrawer-Bp9_ABtu.js";const K=/^(?!https?)(?!www\.?).*\..+$/g,Q=I({username:i(),title:l().min(1,{message:"Enter a business name"}).min(3,{message:"Busines Name must not be less than 3 characters"}).max(100,{message:"Business name must not be more than 100 characters."}),country_code:l({message:"Please select a country"}).min(1,{message:"Please enter a country code."}),address_one:l({message:"Please enter an address"}).min(3,{message:"Address must not be less than 3 characters"}).max(100,{message:"Address must not be more than 100 characters"}),address_two:i(),state_code:i(),state_text:i(),country_text:i(),city:i(),established:l({message:"Please enter year established"}).min(4,{message:"Year must be at least 4 characters"}),call_code:i(),call_mobile:i(),zipcode:i(),intro:i(),category:l().min(2,{message:"Please select a business category"}),business_phrases:l({message:"Please enter business phrase"}).min(3,{message:"Business Phrases must not be less than 3 characters"}).max(1e3,{message:"Business Phrases must not be more than 100 characters"}),products:l({message:"Please enter products offered"}),services:N([l({message:"Please enter services offered"}).min(3,{message:"Please enter up to 3 characters"}),O("")]),xsocial:i(),fbsocial:i(),linksocial:i(),website:N([l().regex(K).nullish(),O("")]),email:l({message:"Please enter an email."}).min(1,{message:"Email must not be empty"}).email({message:"Please enter a valid email"})}).superRefine((o,c)=>{var u,a;((u=o==null?void 0:o.address_two)==null?void 0:u.length)!==0&&((a=o==null?void 0:o.address_two)==null?void 0:a.length)<3&&c.addIssue({code:R.custom,path:["address_two"],message:"Enter a minimum of 3 characters"})}),C=["Closed","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30","24:00"],X=({data:o,onChange:c,options:u})=>{const[a,m]=n.useState(null),[d,g]=n.useState("no_hours"),[v,w]=n.useState(!1);Z();const{showOperation:_,completeOperation:j,showError:h,showSuccess:S}=q(),p=async e=>{const t=e;return{Monday:{start:t.monday_from,end:t.monday_to},Tuesday:{start:t.tuesday_from,end:t.tuesday_to},Wednesday:{start:t.wednesday_from,end:t.wednesday_to},Thursday:{start:t.thursday_from,end:t.thursday_to},Friday:{start:t.friday_from,end:t.friday_to},Saturday:{start:t.saturday_from,end:t.saturday_to},Sunday:{start:t.sunday_from,end:t.sunday_to}}};n.useEffect(()=>{(async()=>{const t=await p(o.operatingHours);m(t),c(t),g(o.operatingHours.open_status)})()},[o.operatingHours]);const P=(e,t,r)=>{if(!a)return;let f=r;if(a[e].end<=f&&f!=="Closed"){alert(`For ${e}, closing time must be later than opening time.`);return}m({...a,[e]:{...a[e],[t]:r}}),c(a)},x=(e,t,r)=>{if(!a)return;let f=a[e].start;if(r<=f&&f!=="Closed"){alert(`For ${e}, closing time must be later than opening time.`);return}m({...a,[e]:{...a[e],[t]:r}}),c(a)},b=async()=>{if(d===null)return h("Error","Please select working hours."),!1;w(!0),_("processing","Request is being processed."),await new Promise(e=>setTimeout(e,1e3));try{const e=await F(d,a,o.businessGuid,o.userGuid);console.log(e),j(),S("Success","Working hours saved."),w(!1)}catch(e){console.log(e.message),h("error","Business working hours could not be saved.")}};return a?s.jsx("div",{children:s.jsx("div",{className:`${U}`,children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"w-full",children:u.map(e=>s.jsxs("label",{className:`flex items-center gap-3 p-3 rounded cursor-pointer ${d===e.value?" bg-blue-50":"border-gray-300"}`,children:[s.jsx("div",{className:"w-[20px]",children:s.jsx("input",{type:"radio",name:"openStatus",value:e.value,checked:d===e.value,onChange:()=>g(e.value),className:"accent-blue-600 w-[20px] h-[20px]"})}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-800",children:e.label}),s.jsx("span",{className:"text-[13px] text-gray-500",children:e.more})]})]},e.value))}),d==="selected_hours"&&Object.keys(a).map(e=>{var t;return s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{className:"w-24 font-semibold",children:e}),s.jsxs("select",{value:((t=a[e])==null?void 0:t.start)||"",onChange:r=>P(e,"start",r.target.value),className:"border p-2 rounded",children:[s.jsx("option",{value:"",children:"From..."}),C.map(r=>s.jsx("option",{value:r,children:r},r))]}),s.jsx("span",{children:"to"}),s.jsxs("select",{value:a[e].end||"",onChange:r=>x(e,"end",r.target.value),className:"border p-2 rounded",children:[s.jsx("option",{value:"",children:"To..."}),C.map(r=>s.jsx("option",{value:r,children:r},r))]})]},e)}),s.jsx("div",{children:s.jsx("button",{onClick:b,className:`mt-6 bg-blue-600 text-white px-6 py-2 
                            rounded hover:bg-blue-700 transition
                            shadow-md hover:shadow-lg hover:shadow-black/50`,children:v?"Saving...":"Save Business Hours"})})]})})}):s.jsx("p",{children:"Loading working hours..."})},ve=()=>{n.useEffect(()=>{$(localStorage)},[]);const[o,c]=n.useState(!0),[u,a]=n.useState(""),[m,d]=n.useState(""),[g,v]=n.useState(),[w,_]=n.useState([]),j=[{value:"no_hours",label:"No Hours Available",more:"Visitors won't see business hours on this Page"},{value:"always_open",label:"Always Open",more:"e.g. Parks, beaches, roads"},{value:"permanently_closed",label:"Permanently Closed",more:"Permantently closed"},{value:"temporarily_closed",label:"Temporarily Closed",more:"Temporarily closed"},{value:"selected_hours",label:"Open During Selected Hours",more:"Open during selected hours"}],[h,S]=n.useState(null),[p,P]=n.useState(null),{business_guid:x,user_guid:b}=L();Y(),n.useEffect(()=>{const T=async(y,k)=>{a(y),d(k);const E=await D(y,k);v(E);const B=await G(y||"");P(B)};try{x&&b&&T(x,b)}catch(y){console.log(y.message)}},[x,b]),n.useEffect(()=>{u&&m&&g&&p&&(S({businessGuid:u,userGuid:m,operatingHours:g,businessProfile:p}),c(!1))},[u,m,g,p]);const{register:e,handleSubmit:t,getValues:r,watch:f,setError:H,formState:{errors:ee,isSubmitting:se}}=A({defaultValues:{},resolver:W(Q)});return o?s.jsx(J,{}):s.jsx(V,{children:s.jsx(M,{title:"Settings",businessGuid:u,data:h,businessProfile:p,children:s.jsx(z,{children:h&&s.jsx("div",{className:"mt-6",children:s.jsx(X,{data:h,onChange:_,options:j})})})})})};export{ve as default};
